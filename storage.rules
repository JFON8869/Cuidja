rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Permite a leitura de qualquer arquivo por qualquer pessoa.
    // Isso é necessário para que as imagens dos produtos e lojas possam ser exibidas publicamente no app.
    allow read: if true;

    // Permite a escrita (create, update, delete) em qualquer caminho
    // apenas se o usuário estiver autenticado.
    // A segurança e organização dos arquivos (separar por userId) é
    // responsabilidade do código do aplicativo, que já está fazendo isso corretamente.
    // Esta regra garante que apenas usuários logados possam enviar arquivos.
    allow write: if request.auth != null;
  }
}
