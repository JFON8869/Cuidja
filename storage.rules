rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Permite a leitura de qualquer arquivo por qualquer pessoa.
    // Isso é necessário para que as imagens dos produtos e lojas possam ser exibidas publicamente no app.
    allow read: if true;

    // Regra específica e segura para LOGOS.
    // Permite que um usuário autenticado escreva apenas na SUA PRÓPRIA pasta de logos.
    match /logos/{userId}/{allPaths=**} {
      allow write: if request.auth != null && request.auth.uid == userId;
    }

    // Regra específica e segura para IMAGENS DE PRODUTOS.
    // Permite que um usuário autenticado escreva apenas na SUA PRÓPRIA pasta de produtos.
    match /products/{userId}/{allPaths=**} {
      allow write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
